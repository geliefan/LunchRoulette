<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="東京エリアのランチスポット発見サービス - 天気情報と位置情報を活用したレストラン推薦">
    <meta name="keywords" content="ランチ,レストラン,東京,天気,グルメ">
    <title>Lunch Roulette - 今日のランチはここで決まり！</title>

    <!-- CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Lunch Roulette - 今日のランチはここで決まり！">
    <meta property="og:description" content="東京エリアのランチスポット発見サービス">
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ request.url }}">
</head>
<body>
    <!-- メインランチセクション -->
    <div class="container">
        <!-- ヘッダーセクション -->
        <header class="header">
            <h1 class="app-title">
                <span class="title-icon">🎯</span>
                Lunch Roulette
            </h1>
            <p class="app-subtitle">今日のランチはここで決まり！</p>
        </header>

        <!-- 位置情報・天気情報セクション -->
        <section class="info-section">
            <!-- 位置情報カード -->
            <div class="info-card location-card">
                <div class="card-header">
                    <span class="card-icon">📍</span>
                    <h2 class="card-title">現在地</h2>
                    {% if is_default_location %}
                    <span class="default-badge">デフォルト</span>
                    {% endif %}
                </div>
                <div class="card-content">
                    <p class="location-text">
                        <span class="city">{{ location.city }}</span>
                        <span class="region">{{ location.region }}</span>
                    </p>
                    <p class="coordinates">
                        {{ "%.4f"|format(location.latitude) }}, {{ "%.4f"|format(location.longitude) }}
                    </p>
                    <!-- GPS位置取得ボタン -->
                    <div class="gps-control">
                        <button id="gps-btn" class="gps-btn" type="button">
                            <span class="btn-icon">🛰️</span>
                            <span class="btn-text">GPS位置を取得</span>
                        </button>
                        <span id="gps-status" class="gps-status"></span>
                    </div>
                </div>
            </div>

            <!-- 天気情報カード -->
            <div class="info-card weather-card">
                <div class="card-header">
                    <span class="card-icon">{{ weather_icon_emoji }}</span>
                    <h2 class="card-title">今日の天気</h2>
                    {% if is_default_weather %}
                    <span class="default-badge">デフォルト</span>
                    {% endif %}
                </div>
                <div class="card-content">
                    <div class="weather-main">
                        <div class="weather-info">
                            <p class="temperature">{{ weather.temperature|round(1) }}°C</p>
                            <p class="description">{{ weather.description }}</p>
                        </div>
                    </div>
                    <div class="weather-details">
                        <div class="weather-detail">
                            <span class="detail-label">UV指数</span>
                            <span class="detail-value">{{ weather.uv_index|round(1) }}</span>
                        </div>
                        <div class="weather-status">
                            {% if is_good_walking_weather %}
                            <span class="status-good">🚶‍♂️ 散歩日和</span>
                            {% else %}
                            <span class="status-caution">⚠️ 天気注意</span>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 検索条件セクション -->
        <section class="search-conditions-section">
            <div class="search-conditions-box">
                <h2 class="box-title">
                    <span class="title-icon">🔍</span>
                    検索条件
                </h2>
                <div class="conditions-grid">
                    <!-- 位置指定モード選択 -->
                    <div class="condition-group mode-select-group">
                        <label class="condition-label">
                            <span class="label-icon">📍</span>
                            位置の指定方法
                        </label>
                        <div class="mode-select-buttons">
                            <button type="button" id="mode-current" class="mode-btn active">
                                <span class="mode-icon">🛰️</span>
                                現在地から探す
                            </button>
                            <button type="button" id="mode-area" class="mode-btn">
                                <span class="mode-icon">🗺️</span>
                                エリアを指定
                            </button>
                        </div>
                    </div>

                    <!-- エリア選択（エリアモード時のみ表示） -->
                    <div class="condition-group" id="area-select-group" style="display: none;">
                        <label class="condition-label" for="area">
                            <span class="label-icon">🗺️</span>
                            エリア
                        </label>
                        <select id="area" class="condition-select">
                            <option value="">エリアを選択してください</option>
                            <!-- エリア選択肢はJavaScriptで動的に追加 -->
                        </select>
                    </div>

                    <!-- 徒歩時間選択（現在地モード時のみ表示） -->
                    <div class="condition-group" id="walking-time-group">
                        <label class="condition-label" for="walking-time-select">
                            <span class="label-icon">🚶</span>
                            徒歩時間
                        </label>
                        <select id="walking-time-select" class="condition-select">
                            <option value="5">〜5分</option>
                            <option value="10" selected>〜10分</option>
                            <option value="15">〜15分</option>
                            <option value="20">〜20分</option>
                            <option value="30">20分超</option>
                        </select>
                    </div>

                    <!-- 予算カテゴリ選択 -->
                    <div class="condition-group">
                        <label class="condition-label" for="budget">
                            <span class="label-icon">💰</span>
                            予算
                        </label>
                        <select id="budget" class="condition-select">
                            <option value="">すべて</option>
                            <option value="B009">〜500円</option>
                            <option value="B010" selected>〜1000円</option>
                            <option value="B011">〜1500円</option>
                            <option value="B001">〜2000円</option>
                            <option value="B002">〜3000円</option>
                        </select>
                    </div>

                    <!-- ジャンル選択 -->
                    <div class="condition-group">
                        <label class="condition-label" for="genre">
                            <span class="label-icon">🍽️</span>
                            ジャンル
                        </label>
                        <select id="genre" class="condition-select">
                            <option value="">指定なし</option>
                            <!-- ジャンル選択肢はJavaScriptで動的に追加 -->
                        </select>
                    </div>
                </div>
            </div>
        </section>

        <!-- ルーレットセクション -->
        <section class="roulette-section">
            <div class="roulette-container">
                <h2 class="section-title">ランチルーレット</h2>
                <p class="section-description">
                    条件を指定してランチスポットをランダムに選びます
                </p>

                <!-- ルーレットボタン -->
                <button id="roulette-btn" class="roulette-btn" type="button">
                    <span class="btn-icon">🎲</span>
                    <span class="btn-text">ルーレットを回す</span>
                    <span class="btn-loading" style="display: none;">
                        <span class="spinner"></span>
                        検索中...
                    </span>
                </button>

                <!-- エラーメッセージ表示エリア -->
                <div id="error-message" class="error-message" style="display: none;">
                    <span class="error-icon">⚠️</span>
                    <span class="error-text"></span>
                </div>
            </div>
        </section>

        <!-- レストランカード表示エリア -->
        <section class="restaurant-section" id="restaurant-section" style="display: none;">
            <div class="restaurant-card" id="restaurant-card">
                <!-- レストラン情報がJavaScriptで動的に挿入されます -->
                <div class="card-header">
                    <h3 class="restaurant-name" id="restaurant-name"></h3>
                    <span class="restaurant-genre" id="restaurant-genre"></span>
                </div>
                
                <div class="card-image">
                    <img id="restaurant-image" src="" alt="レストラン画像" class="restaurant-photo">
                    <div class="image-overlay">
                        <span class="distance-badge" id="distance-badge"></span>
                    </div>
                </div>
                
                <div class="card-content">
                    <div class="restaurant-info">
                        <div class="info-row">
                            <span class="info-label">📍 住所</span>
                            <span class="info-value" id="restaurant-address"></span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">💰 予算</span>
                            <span class="info-value" id="restaurant-budget"></span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">🚶‍♂️ 徒歩</span>
                            <span class="info-value" id="walking-time"></span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">🕒 営業時間</span>
                            <span class="info-value" id="restaurant-hours"></span>
                        </div>
                    </div>
                    
                    <div class="restaurant-description">
                        <p id="restaurant-catch"></p>
                    </div>
                    
                    <div class="action-buttons">
                        <a id="map-link" href="#" target="_blank" class="btn btn-primary">
                            <span class="btn-icon">🗺️</span>
                            地図で見る
                        </a>
                        <a id="hotpepper-link" href="#" target="_blank" class="btn btn-secondary">
                            <span class="btn-icon">🔗</span>
                            詳細を見る
                        </a>
                    </div>
                </div>
            </div>
            
            <!-- 再ルーレットボタン -->
            <div class="retry-section">
                <button id="retry-btn" class="retry-btn" type="button">
                    <span class="btn-icon">🔄</span>
                    もう一度回す
                </button>
            </div>
        </section>

        <!-- フッター -->
        <footer class="footer">
            <div class="footer-content">
                <p class="footer-text">
                    Powered by 
                    <a href="https://webservice.recruit.co.jp/hotpepper/" target="_blank" rel="noopener">Hot Pepper Gourmet API</a>
                    & 
                    <a href="https://openweathermap.org/" target="_blank" rel="noopener">OpenWeatherMap API</a>
                </p>
                <p class="footer-note">
                    ※ 位置情報はIPアドレスから推定されます。実際の位置と異なる場合があります。
                </p>
            </div>
        </footer>
    </div>

    <!-- JavaScript -->
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>